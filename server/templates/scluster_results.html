$def with (k, clusters_result_form, data_path, no_graphics)
<html>
<head>
  <script type="text/javascript" src="server/static/js/protovis-d3.2.js"></script>
  <script type="text/javascript" src="server/static/js/$data_path"></script>
</head>

<body>
  <h3>Clusters generated by scluster for k = $k</h3>
  $:clusters_result_form.render()

  $if not no_graphics:
    <script type="text/javascript+protovis">
	
	var w = document.body.clientWidth - 40;
	h = document.body.clientHeight,
	colors = pv.Colors.category19();
    
	var cur_zoom = 0.0000000000000000000001;
	
	var vis = new pv.Panel()
	    .width(w)
	    .height(h)
	    .fillStyle("white")
	    //    .event("mousedown", pv.Behavior.pan())
	    .event("mousewheel", pv.Behavior.zoom(10))
	    .event("mousedown", pv.Behavior.select())
	    .event("selectstart", function(a) { alert(a);})
	    .event("select", function(a) { alert(a);})
			
    //    .event("select", function() {alert(4);})

	 vis.width(w);
	 vis.height(h);

	 pv.Behavior.zoom(10).bound(50);
	 function zoom_out() 
	 { 
	       cur_zoom = cur_zoom / 10.0; 
	       vis.transform(pv.Transform.identity.scale(cur_zoom).translate((Math.round(w / cur_zoom) - w)/2, (Math.round(h/cur_zoom) - h)/2)); 
               vis.width(w);
               vis.height(h);
               vis.render(); 
         }; 
         
         var force = vis.add(pv.Layout.Force)
         .nodes(data.nodes)
         .links(data.links)
         .bound(true) 	
         .chargeConstant(-50)
         .chargeMaxDistance(500) 
         .springConstant(0.05)
         .springLength(0)
         //.iterations(10);
         
	
         force.link.add(pv.Line);
         
         force.node.add(pv.Dot)
         .size(function(d) (d.linkDegree + 4) * Math.pow(this.scale, -1.5))
         .fillStyle(pv.Colors.category10().by(function(d) d.group)) 
         //.fillStyle(function(d) d.fix ? "brown" : colors(d.group))
         .strokeStyle(function() this.fillStyle().darker())
         .lineWidth(1)
         .title(function(d) d.nodeName)
         .event("mousedown", pv.Behavior.drag())
         .event("drag", force)
         .event("click", function(d) { alert(d.nodeName);})
         
         vis.render();
         
         </script>
  </body>
</html>
